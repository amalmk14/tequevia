{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Account</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

  <link href="{% static 'css/account.css' %}" rel="stylesheet">
 
</head>
<body>

{% include "navbar.html" %}

<div class="container">
  <div class="d-flex flex-md-row gap-4">

    <div class="sidebar-box d-none d-md-block" style="width: 100%; max-width: 300px;">
      <div class="sidebar-header">
        <div class="avatar"></div>
        <div class="user-info">
          <small>Hello,</small>
          <strong>Amal Mk</strong>
        </div>
      </div>

      <div class="sidebar-section-title">ACCOUNT SETTINGS</div>
      <div class="sidebar-item" onclick="showSection('profile')"><i class="fa-solid fa-user"></i> Profile Information</div>
      <div class="sidebar-item" onclick="showSection('address')"><i class="fa-solid fa-location-dot"></i> Manage Addresses</div>

      <div class="sidebar-section-title">MY STUFF</div>
      <div class="sidebar-item"><i class="fa-solid fa-heart"></i> Wishlist</div>
      <div class="sidebar-item"><i class="fa-solid fa-cart-shopping"></i> Cart</div>
      <div class="sidebar-item"><i class="fa-solid fa-bag-shopping"></i> Orders</div>

      <div class="sidebar-section-title">OTHER</div>
      <div class="sidebar-item"><i class="fa-solid fa-gear"></i> Settings</div>
      <div class="sidebar-item"><i class="fa-solid fa-arrow-right-from-bracket"></i> Logout</div>
    </div>

    <!-- Mobile Sidebar -->
    <div class="mobile-slider-box d-block d-md-none">
      <div class="mobile-header">Amal Mk</div>

      <div class="mobile-grid">
        <!-- Row 1: Profile + Address -->
        <div class="grid-2">
          <div class="grid-item">
            <i class="fa-solid fa-user"></i>
            <div onclick="showSection('profile')">Profile</div>
          </div>
          <div class="grid-item">
            <i class="fa-solid fa-location-dot"></i>
            <div onclick="showSection('address')">Address</div>
          </div>
        </div>

        <!-- Row 2: Orders + Wishlist + Cart -->
        <div class="grid-3">
          <div class="grid-item">
            <i class="fa-solid fa-bag-shopping"></i>
            <div>Orders</div>
          </div>
          <div class="grid-item">
            <i class="fa-regular fa-heart"></i>
            <div>Wishlist</div>
          </div>
          <div class="grid-item">
            <i class="fa-solid fa-cart-shopping"></i>
            <div>Cart</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Profile Card -->
    <div class="pi-edit-card flex-grow-1" id="profile-section">
      <h4>Edit Profile</h4>
      <form>

        <!-- Full Name -->
        <div class="mb-3 d-flex align-items-start justify-content-between flex-wrap">
          <div class="w-50 pe-3">
            <label for="name" class="form-label pi-form-label d-flex justify-content-between align-items-center">
              <span>Full Name</span>
              <button type="button" class="btn pi-toggle-edit" data-target="#name">Edit</button>
            </label>
            <div class="input-wrapper">
              <input type="text" class="form-control" id="name" value="Amal Mk" readonly />
            </div>
          </div>
          <div class="mt-4">
            <button type="button" class="btn btn-save btn-sm save-btn" data-target="#name" style="display: none;">Save</button>
          </div>
        </div>

        <!-- Email -->
        <div class="mb-3 d-flex align-items-start justify-content-between flex-wrap">
          <div class="w-50 pe-3">
            <label for="email" class="form-label pi-form-label d-flex justify-content-between align-items-center">
              <span>Email Address</span>
              <button type="button" class="btn pi-toggle-edit" data-target="#email">Edit</button>
            </label>
            <div class="input-wrapper">
            <input type="email" class="form-control" id="email" value="amal@example.com" readonly />
            </div>
          </div>
          <div class="mt-4">
            <button type="button" class="btn btn-save btn-sm save-btn" data-target="#email" style="display: none;">Save</button>
          </div>
        </div>

        <!-- Phone -->
        <div class="mb-3 d-flex align-items-start justify-content-between flex-wrap">
          <div class="w-50 pe-3">
            <label for="phone" class="form-label pi-form-label d-flex justify-content-between align-items-center">
              <span>Phone Number</span>
              <button type="button" class="btn pi-toggle-edit" data-target="#phone">Edit</button>
            </label>
            <div class="input-wrapper">
            <input type="tel" class="form-control pi-form-control" id="phone" value="+91 9876543210" readonly />
            </div>
          </div>
          <div class="mt-4">
            <button type="button" class="btn btn-save btn-sm save-btn" data-target="#phone" style="display: none;">Save</button>
          </div>
        </div>

      </form>
    </div>

    {% comment %} address card {% endcomment %}
    <div id="address-section" class="container address-container my-4 d-none flex-grow-1">
      <h4 class="address-heading mb-3">Manage Addresses</h4>
      <button class="btn btn-link text-primary address-add-btn mb-3" data-bs-toggle="collapse" data-bs-target="#address-form" aria-expanded="false" aria-controls="address-form">
        + ADD A NEW ADDRESS
      </button>

      <!-- Collapsible Form -->
      <div class="collapse address-form-container mb-4" id="address-form">
        <div class="card card-body border address-form-card">
          <form>
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Name</label>
                <input type="text" class="form-control" placeholder="Name">
              </div>
              <div class="col-md-6">
                <label class="form-label">10-digit mobile number</label>
                <input type="tel" class="form-control" placeholder="10-digit mobile number">
              </div>
              <div class="col-md-6">
                <label class="form-label">Pincode</label>
                <input type="text" class="form-control">
              </div>
              <div class="col-md-6">
                <label class="form-label">Locality</label>
                <input type="text" class="form-control">
              </div>
              <div class="col-12">
                <label class="form-label">Address (Area and Street)</label>
                <input type="text" class="form-control">
              </div>
              <div class="col-md-6">
                <label class="form-label">City/District/Town</label>
                <input type="text" class="form-control">
              </div>
              <div class="col-md-6">
                <label class="form-label">State</label>
                <select class="form-select">
                  <option>--Select State--</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label">Landmark (Optional)</label>
                <input type="text" class="form-control">
              </div>
              <div class="col-md-6">
                <label class="form-label">Alternate Phone (Optional)</label>
                <input type="text" class="form-control">
              </div>
            </div>

            <!-- Address Type -->
            <div class="mt-3">
              <label class="form-label d-block">Address Type</label>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="addressType" id="home" value="home" checked>
                <label class="form-check-label" for="home">Home</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="addressType" id="work" value="work">
                <label class="form-check-label" for="work">Work</label>
              </div>
            </div>

            <!-- Save / Cancel Buttons -->
            <div class="mt-3 d-flex gap-3">
              <button type="submit" class="btn btn-primary px-4">SAVE</button>
              <button type="button" class="btn btn-secondary" data-bs-toggle="collapse" data-bs-target="#address-form" aria-expanded="true">CANCEL</button>
            </div>
          </form>

        </div>
      </div>

      <!-- Address Card 1 -->
      <div class="address-card">
        <div class="d-flex justify-content-between">
          <div>
            <strong class="text-uppercase">Work</strong><br />
            <strong>Amal</strong> &nbsp;&nbsp; <span>8089561155</span><br />
            <span>123, Koottuli, Kozhikode, Kerala - 673016</span>
          </div>

          <div class="address-menu">
            <span class="address-3dot">⋮</span>
            <div class="address-dropdown">
              <a href="#" class="address-edit-btn">Edit</a>
              <a href="#" class="address-delete-btn" data-bs-toggle="modal" data-bs-target="#deleteModal">Delete</a>
            </div>
          </div>
        </div>

        <!-- Edit Form -->
        <div class="address-edit-form">
          <h6>Edit Address</h6>
          <form>
            <div class="row mb-2">
              <div class="col-md-6">
                <label class="form-label">Name</label>
                <input type="text" class="form-control" value="Amal" />
              </div>
              <div class="col-md-6">
                <label class="form-label">10-digit mobile number</label>
                <input type="text" class="form-control" value="8089561155" />
              </div>
            </div>
            <div class="row mb-2">
              <div class="col-md-4">
                <label class="form-label">Pincode</label>
                <input type="text" class="form-control" value="673016" />
              </div>
              <div class="col-md-4">
                <label class="form-label">Locality</label>
                <input type="text" class="form-control" value="Koottuli" />
              </div>
              <div class="col-md-4">
                <label class="form-label">Address (Area and Street)</label>
                <input type="text" class="form-control" value="123" />
              </div>
            </div>
            <div class="row mb-2">
              <div class="col-md-4">
                <label class="form-label">City/District/Town</label>
                <input type="text" class="form-control" value="Kozhikode" />
              </div>
              <div class="col-md-4">
                <label class="form-label">State</label>
                <input type="text" class="form-control" value="Kerala" />
              </div>
              <div class="col-md-4">
                <label class="form-label">Landmark</label>
                <input type="text" class="form-control" value="Ottokandy Sree Bhadrakali Temple" />
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label">Address Type</label><br />
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="type" checked />
                <label class="form-check-label">Home</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="type" />
                <label class="form-check-label">Work</label>
              </div>
            </div>
            <button type="submit" class="btn btn-primary">Save</button>
            <button type="button" class="btn btn-secondary address-cancel-edit">Cancel</button>
          </form>
        </div>

      </div>

      <!-- Address Card 2 -->
      <div class="address-card">
        <div class="d-flex justify-content-between">
          <div>
            <strong class="text-uppercase">Work</strong><br />
            <strong>Amal</strong> &nbsp;&nbsp; <span>8089561155</span><br />
            <span>123, Koottuli, Kozhikode, Kerala - 673016</span>
          </div>

          <div class="address-menu">
            <span class="address-3dot">⋮</span>
            <div class="address-dropdown">
              <a href="#" class="address-edit-btn">Edit</a>
              <a href="#" class="address-delete-btn" data-bs-toggle="modal" data-bs-target="#deleteModal">Delete</a>
            </div>
          </div>
        </div>

          <!-- Edit Form -->
          <div class="address-edit-form">
            <h6>Edit Address</h6>
            <form>
              <div class="row mb-2">
                <div class="col-md-6">
                  <label class="form-label">Name</label>
                  <input type="text" class="form-control" value="Amal" />
                </div>
                <div class="col-md-6">
                  <label class="form-label">10-digit mobile number</label>
                  <input type="text" class="form-control" value="8089561155" />
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4">
                  <label class="form-label">Pincode</label>
                  <input type="text" class="form-control" value="673016" />
                </div>
                <div class="col-md-4">
                  <label class="form-label">Locality</label>
                  <input type="text" class="form-control" value="Koottuli" />
                </div>
                <div class="col-md-4">
                  <label class="form-label">Address (Area and Street)</label>
                  <input type="text" class="form-control" value="123" />
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-4">
                  <label class="form-label">City/District/Town</label>
                  <input type="text" class="form-control" value="Kozhikode" />
                </div>
                <div class="col-md-4">
                  <label class="form-label">State</label>
                  <input type="text" class="form-control" value="Kerala" />
                </div>
                <div class="col-md-4">
                  <label class="form-label">Landmark</label>
                  <input type="text" class="form-control" value="Ottokandy Sree Bhadrakali Temple" />
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Address Type</label><br />
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="type" checked />
                  <label class="form-check-label">Home</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="type" />
                  <label class="form-check-label">Work</label>
                </div>
              </div>
              <button type="submit" class="btn btn-primary">Save</button>
              <button type="button" class="btn btn-secondary address-cancel-edit">Cancel</button>
            </form>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <!-- Delete Modal -->
  <div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content text-center p-4">
        <h5><strong>Are you sure you want to delete this address?</strong></h5>
        <div class="mt-4 d-flex justify-content-center gap-3">
          <button class="btn btn-danger" data-bs-dismiss="modal">Yes, Delete</button>
          <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>

{% include "footer.html" %}
<script>
  const originalValues = {};

  document.querySelectorAll('.pi-toggle-edit').forEach(btn => {
    btn.addEventListener('click', function () {
      const inputId = this.dataset.target;
      const input = document.querySelector(inputId);
      const saveBtn = document.querySelector('.save-btn[data-target="' + inputId + '"]');
      const isEditMode = this.textContent === 'Edit';

      // If switching to edit mode
      if (isEditMode) {
        // Cancel all others first
        document.querySelectorAll('.pi-toggle-edit').forEach(b => {
          const otherInputId = b.dataset.target;
          const otherInput = document.querySelector(otherInputId);
          const otherSaveBtn = document.querySelector('.save-btn[data-target="' + otherInputId + '"]');

          if (b !== this && b.textContent === 'Cancel') {
            otherInput.setAttribute('readonly', true);
            otherInput.value = originalValues[otherInputId] ?? otherInput.value;
            b.textContent = 'Edit';
            otherSaveBtn.style.display = 'none';
          }
        });

        // Store original value only if not already stored
        if (!(inputId in originalValues)) {
          originalValues[inputId] = input.value;
        }

        input.removeAttribute('readonly');
        saveBtn.style.display = 'inline-block';
        this.textContent = 'Cancel';
      } else {
        // Cancel edit and restore original
        input.value = originalValues[inputId];
        input.setAttribute('readonly', true);
        saveBtn.style.display = 'none';
        this.textContent = 'Edit';
      }
    });
  });

  document.querySelectorAll('.save-btn').forEach(btn => {
    btn.addEventListener('click', function () {
      const inputId = this.dataset.target;
      const input = document.querySelector(inputId);
      const toggleBtn = document.querySelector('.pi-toggle-edit[data-target="' + inputId + '"]');

      // Save value
      originalValues[inputId] = input.value;

      input.setAttribute('readonly', true);
      this.style.display = 'none';
      toggleBtn.textContent = 'Edit';

      // Optional: AJAX call to save to server here
    });
  });
</script>

{% comment %} card display and hides {% endcomment %}
<script>
  function showSection(section) {
    const profileSection = document.getElementById('profile-section');
    const addressSection = document.getElementById('address-section');

    if (section === 'profile') {
      profileSection.classList.remove('d-none');
      addressSection.classList.add('d-none');
    } else if (section === 'address') {
      addressSection.classList.remove('d-none');
      profileSection.classList.add('d-none');
    }

    // Optional: highlight active sidebar item
    document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active'));
    if (section === 'profile') {
      document.querySelector('.sidebar-item i.fa-user').parentElement.classList.add('active');
    } else {
      document.querySelector('.sidebar-item i.fa-location-dot').parentElement.classList.add('active');
    }
  }
</script>


<script>
    // Toggle 3-dot menu
    document.querySelectorAll(".address-3dot").forEach(dot => {
      dot.addEventListener("click", function (e) {
        e.stopPropagation();
        document.querySelectorAll(".address-dropdown").forEach(d => d.style.display = "none");
        this.nextElementSibling.style.display = "block";
      });
    });

    // Hide dropdown on outside click
    document.addEventListener("click", function () {
      document.querySelectorAll(".address-dropdown").forEach(d => d.style.display = "none");
    });

    // Show/Hide edit form
    document.querySelectorAll(".address-edit-btn").forEach(btn => {
      btn.addEventListener("click", function (e) {
        e.preventDefault();
        const card = this.closest(".address-card");
        const form = card.querySelector(".address-edit-form");
        form.style.display = form.style.display === "block" ? "none" : "block";
        card.querySelector(".address-dropdown").style.display = "none";
      });
    });

    // Cancel edit
    document.querySelectorAll(".address-cancel-edit").forEach(btn => {
      btn.addEventListener("click", function () {
        this.closest(".address-edit-form").style.display = "none";
      });
    });
  </script>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
